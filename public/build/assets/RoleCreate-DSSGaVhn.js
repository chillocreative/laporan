import{o as D,c as i,a as s,f as b,g as x,s as L,w as U,t as c,d as h,e as f,v as _,F as k,q as w,i as $,r as p,j as z,k as n,h as y,L as E}from"./app-C4KUgVyX.js";import{u as I}from"./useNotification-Dk22ynPJ.js";import{r as C}from"./roles-vqMtgHoS.js";import{_ as O}from"./LoadingSpinner-BnFVoTYS.js";/* empty css            */import"./notifications-DWxlJY1z.js";const T={class:"max-w-3xl mx-auto"},A={class:"mb-6"},N={key:1,class:"card"},H={class:"card-body"},J={key:0,class:"rounded-lg bg-red-50 p-3 text-sm text-red-700"},K={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Q={class:"space-y-4"},W={class:"flex items-center gap-3 mb-3"},X=["id","checked","indeterminate","onChange"],Y=["for"],Z={class:"text-xs text-gray-400"},ee={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2 ml-7"},se=["value"],te={key:0,class:"text-sm text-gray-400 mt-2"},le={class:"flex items-center justify-end gap-3 pt-4 border-t border-gray-100"},ae=["disabled"],me={__name:"RoleCreate",setup(oe){const S=z(),R=I(),t=p({name:"",slug:"",permissions:[]}),u=p({}),g=p(!0),v=p(!1),m=p("");function V(){t.value.slug=t.value.name.toLowerCase().trim().replace(/[^a-z0-9\s-]/g,"").replace(/[\s]+/g,"-").replace(/-+/g,"-")}function M(a){const e=u.value[a]||[];return e.length>0&&e.every(r=>t.value.permissions.includes(r.id))}function B(a){const e=u.value[a]||[],r=e.filter(o=>t.value.permissions.includes(o.id)).length;return r>0&&r<e.length}function F(a){return(u.value[a]||[]).filter(r=>t.value.permissions.includes(r.id)).length}function P(a,e){const o=(u.value[a]||[]).map(l=>l.id);if(e){const l=new Set(t.value.permissions);o.forEach(d=>l.add(d)),t.value.permissions=[...l]}else t.value.permissions=t.value.permissions.filter(l=>!o.includes(l))}async function j(){g.value=!0;try{const{data:a}=await C.permissions();u.value=a.data}catch{m.value="Failed to load permissions."}g.value=!1}async function G(){v.value=!0,m.value="";try{await C.create({name:t.value.name,slug:t.value.slug,permissions:t.value.permissions}),R.success("Role created successfully!"),S.push({name:"roles.index"})}catch(a){const e=a.response?.data?.errors;m.value=e?Object.values(e).flat()[0]:"Failed to create role."}finally{v.value=!1}}return D(()=>j()),(a,e)=>{const r=$("router-link");return n(),i("div",T,[s("div",A,[b(r,{to:{name:"roles.index"},class:"text-sm text-gray-500 hover:text-primary-600 mb-1 inline-block"},{default:x(()=>[...e[3]||(e[3]=[y("â† Back to Roles",-1)])]),_:1}),e[4]||(e[4]=s("h1",{class:"page-title"},"Create New Role",-1)),e[5]||(e[5]=s("p",{class:"page-subtitle"},"Define a new role with specific permissions",-1))]),g.value?(n(),L(O,{key:0,"full-page":""})):(n(),i("div",N,[s("div",H,[s("form",{onSubmit:U(G,["prevent"]),class:"space-y-6"},[m.value?(n(),i("div",J,c(m.value),1)):h("",!0),s("div",K,[s("div",null,[e[6]||(e[6]=s("label",{class:"label-text"},"Role Name *",-1)),f(s("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>t.value.name=o),onInput:V,type:"text",required:"",class:"input-field",placeholder:"e.g. Content Manager"},null,544),[[_,t.value.name]])]),s("div",null,[e[7]||(e[7]=s("label",{class:"label-text"},"Slug *",-1)),f(s("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>t.value.slug=o),type:"text",required:"",class:"input-field",placeholder:"e.g. content-manager"},null,512),[[_,t.value.slug]])])]),s("div",null,[e[8]||(e[8]=s("label",{class:"label-text mb-3"},"Permissions",-1)),s("div",Q,[(n(!0),i(k,null,w(u.value,(o,l)=>(n(),i("div",{key:l,class:"border border-gray-200 rounded-lg p-4"},[s("div",W,[s("input",{type:"checkbox",id:`group-${l}`,checked:M(l),indeterminate:B(l),onChange:d=>P(l,d.target.checked),class:"h-4 w-4 text-primary-600 rounded border-gray-300 focus:ring-primary-500"},null,40,X),s("label",{for:`group-${l}`,class:"text-sm font-semibold text-gray-700 capitalize"},c(l),9,Y),s("span",Z," ("+c(F(l))+"/"+c(o.length)+") ",1)]),s("div",ee,[(n(!0),i(k,null,w(o,d=>(n(),i("label",{key:d.id,class:"flex items-center gap-2 text-sm text-gray-600 cursor-pointer"},[f(s("input",{type:"checkbox",value:d.id,"onUpdate:modelValue":e[2]||(e[2]=q=>t.value.permissions=q),class:"h-4 w-4 text-primary-600 rounded border-gray-300 focus:ring-primary-500"},null,8,se),[[E,t.value.permissions]]),y(" "+c(d.name),1)]))),128))])]))),128))]),Object.keys(u.value).length?h("",!0):(n(),i("p",te,"No permissions available."))]),s("div",le,[b(r,{to:{name:"roles.index"},class:"btn-secondary"},{default:x(()=>[...e[9]||(e[9]=[y("Cancel",-1)])]),_:1}),s("button",{type:"submit",disabled:v.value,class:"btn-primary"},c(v.value?"Creating...":"Create Role"),9,ae)])],32)])]))])}}};export{me as default};
