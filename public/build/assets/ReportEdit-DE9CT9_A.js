import{o as N,c as n,a as t,f as m,g as x,s as S,w as j,t as v,d as B,e as f,v as _,E as T,F as U,q,r as l,y as D,j as R,i as A,n as C,k as r,h as k}from"./app-D7nogW7V.js";import{u as F}from"./useNotification-D2PjxE6j.js";import{r as w}from"./reports-DOW6EZM5.js";import{c as O}from"./categories-C04Cv23W.js";import{_ as $,a as K}from"./RichTextEditor-C0Ikj8jD.js";import{_ as G}from"./LoadingSpinner-CUYk7edN.js";/* empty css            */import"./notifications-DUq4YrNs.js";const I={class:"max-w-3xl mx-auto"},P={class:"mb-6"},z={key:1,class:"card"},H={class:"card-body"},J={key:0,class:"rounded-lg bg-red-50 p-3 text-sm text-red-700"},Q={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},W=["value"],X={class:"flex items-center justify-end gap-3 pt-4 border-t border-gray-100"},Y=["disabled"],ie={__name:"ReportEdit",props:{id:[String,Number]},setup(V){const h=V,E=C(),b=R(),L=F(),i=D(()=>h.id||E.params.id),y=l([]),s=l({title:"",category:"",description:"",incident_date:""}),c=l([]),g=l(!0),d=l(!1),u=l("");N(async()=>{try{const o=await O.active();y.value=o.data.data}catch{}try{const{data:o}=await w.get(i.value),e=o.data;s.value={title:e.title,category:e.category,description:e.description,incident_date:e.incident_date}}catch{b.push({name:"reports.index"})}g.value=!1});async function M(){d.value=!0,u.value="";try{const o=new FormData;Object.entries(s.value).forEach(([e,p])=>o.append(e,p)),c.value.forEach(e=>o.append("attachments[]",e)),await w.update(i.value,o),L.success("Laporan dikemas kini!"),b.push({name:"reports.show",params:{id:i.value}})}catch(o){const e=o.response?.data?.errors;u.value=e?Object.values(e).flat()[0]:"Gagal mengemas kini."}finally{d.value=!1}}return(o,e)=>{const p=A("router-link");return r(),n("div",I,[t("div",P,[m(p,{to:{name:"reports.show",params:{id:i.value}},class:"text-sm text-gray-500 hover:text-primary-600 mb-1 inline-block"},{default:x(()=>[...e[5]||(e[5]=[k("â† Kembali",-1)])]),_:1},8,["to"]),e[6]||(e[6]=t("h1",{class:"page-title"},"Edit Laporan",-1))]),g.value?(r(),S(G,{key:0,"full-page":""})):(r(),n("div",z,[t("div",H,[t("form",{onSubmit:j(M,["prevent"]),class:"space-y-5"},[u.value?(r(),n("div",J,v(u.value),1)):B("",!0),t("div",null,[e[7]||(e[7]=t("label",{class:"label-text"},"Tajuk *",-1)),f(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>s.value.title=a),type:"text",required:"",class:"input-field"},null,512),[[_,s.value.title]])]),t("div",Q,[t("div",null,[e[8]||(e[8]=t("label",{class:"label-text"},"Kategori *",-1)),f(t("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>s.value.category=a),required:"",class:"input-field"},[(r(!0),n(U,null,q(y.value,a=>(r(),n("option",{key:a,value:a},v(a),9,W))),128))],512),[[T,s.value.category]])]),t("div",null,[e[9]||(e[9]=t("label",{class:"label-text"},"Tarikh *",-1)),f(t("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>s.value.incident_date=a),type:"date",required:"",class:"input-field"},null,512),[[_,s.value.incident_date]])])]),t("div",null,[e[10]||(e[10]=t("label",{class:"label-text"},"Laporan *",-1)),m($,{modelValue:s.value.description,"onUpdate:modelValue":e[3]||(e[3]=a=>s.value.description=a)},null,8,["modelValue"])]),m(K,{modelValue:c.value,"onUpdate:modelValue":e[4]||(e[4]=a=>c.value=a),label:"Tambah Lampiran Lagi"},null,8,["modelValue"]),t("div",X,[m(p,{to:{name:"reports.show",params:{id:i.value}},class:"btn-secondary"},{default:x(()=>[...e[11]||(e[11]=[k("Batal",-1)])]),_:1},8,["to"]),t("button",{type:"submit",disabled:d.value,class:"btn-primary"},v(d.value?"Menyimpan...":"Simpan Perubahan"),9,Y)])],32)])]))])}}};export{ie as default};
