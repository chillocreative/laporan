import{o as S,c as n,a,f as k,g as _,s as U,w as j,t as d,d as p,e as u,v as f,E as h,F as q,q as C,L,y as R,r as v,j as A,i as K,G as O,n as D,k as i,h as w}from"./app-CQob2CXV.js";import{u as F}from"./useNotification-q_vuiReD.js";import{u as V}from"./users-C-5nBVbu.js";import{r as G}from"./roles-Db10dzzm.js";import{_ as T}from"./LoadingSpinner-C2gbwHS5.js";/* empty css            */import"./notifications-DGFlpOIp.js";const I={class:"max-w-3xl mx-auto"},$={class:"mb-6"},z={key:1,class:"card"},H={class:"card-body"},J={key:0,class:"rounded-lg bg-red-50 p-3 text-sm text-red-700"},Q={key:0,class:"mt-1 text-xs text-red-600"},W={key:0,class:"mt-1 text-xs text-red-600"},X={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Y={key:0,class:"mt-1 text-xs text-red-600"},Z={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},ee=["value"],ae={key:0,class:"mt-1 text-xs text-red-600"},se={class:"flex items-end"},te={class:"flex items-center gap-2 cursor-pointer"},le={class:"flex items-center justify-end gap-3 pt-4 border-t border-gray-100"},oe=["disabled"],ve={__name:"UserEdit",props:{id:[String,Number]},setup(B){const E=B,M=D(),g=A(),N=F(),x=R(()=>E.id||M.params.id),s=v({name:"",email:"",password:"",password_confirmation:"",role_id:"",is_active:!0}),y=v([]),b=v(!0),c=v(!1),m=v(""),l=O({});S(async()=>{try{const[o,e]=await Promise.all([V.get(x.value),G.assignable()]),r=o.data.data;s.value={name:r.name,email:r.email,password:"",password_confirmation:"",role_id:r.roles?.[0]?.id||"",is_active:!!r.is_active},y.value=e.data.data}catch{g.push({name:"users.index"})}b.value=!1});async function P(){c.value=!0,m.value="",Object.keys(l).forEach(o=>delete l[o]);try{const o={name:s.value.name,email:s.value.email,role_ids:[s.value.role_id],is_active:s.value.is_active?1:0};s.value.password&&(o.password=s.value.password,o.password_confirmation=s.value.password_confirmation),await V.update(x.value,o),N.success("Pengguna berjaya dikemas kini!"),g.push({name:"users.index"})}catch(o){const e=o.response?.data?.errors;e?(Object.entries(e).forEach(([r,t])=>{l[r]=t[0]}),m.value=Object.values(e).flat()[0]):m.value=o.response?.data?.message||"Gagal mengemas kini pengguna."}finally{c.value=!1}}return(o,e)=>{const r=K("router-link");return i(),n("div",I,[a("div",$,[k(r,{to:{name:"users.index"},class:"text-sm text-gray-500 hover:text-primary-600 mb-1 inline-block"},{default:_(()=>[...e[6]||(e[6]=[w("â† Kembali ke Pengguna",-1)])]),_:1}),e[7]||(e[7]=a("h1",{class:"page-title"},"Edit Pengguna",-1))]),b.value?(i(),U(T,{key:0,"full-page":""})):(i(),n("div",z,[a("div",H,[a("form",{onSubmit:j(P,["prevent"]),class:"space-y-5"},[m.value?(i(),n("div",J,d(m.value),1)):p("",!0),a("div",null,[e[8]||(e[8]=a("label",{class:"label-text"},"Nama *",-1)),u(a("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>s.value.name=t),type:"text",required:"",class:"input-field"},null,512),[[f,s.value.name]]),l.name?(i(),n("p",Q,d(l.name),1)):p("",!0)]),a("div",null,[e[9]||(e[9]=a("label",{class:"label-text"},"E-mel *",-1)),u(a("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>s.value.email=t),type:"email",required:"",class:"input-field"},null,512),[[f,s.value.email]]),l.email?(i(),n("p",W,d(l.email),1)):p("",!0)]),a("div",X,[a("div",null,[e[10]||(e[10]=a("label",{class:"label-text"},"Kata Laluan Baru",-1)),u(a("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>s.value.password=t),type:"password",class:"input-field",placeholder:"Biarkan kosong untuk kekalkan yang sedia ada"},null,512),[[f,s.value.password]]),l.password?(i(),n("p",Y,d(l.password),1)):p("",!0)]),a("div",null,[e[11]||(e[11]=a("label",{class:"label-text"},"Sahkan Kata Laluan",-1)),u(a("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>s.value.password_confirmation=t),type:"password",class:"input-field",placeholder:"Biarkan kosong untuk kekalkan yang sedia ada"},null,512),[[f,s.value.password_confirmation]])])]),a("div",Z,[a("div",null,[e[13]||(e[13]=a("label",{class:"label-text"},"Peranan *",-1)),u(a("select",{"onUpdate:modelValue":e[4]||(e[4]=t=>s.value.role_id=t),required:"",class:"input-field"},[e[12]||(e[12]=a("option",{value:""},"Pilih peranan",-1)),(i(!0),n(q,null,C(y.value,t=>(i(),n("option",{key:t.id,value:t.id},d(t.name),9,ee))),128))],512),[[h,s.value.role_id]]),l.role_ids?(i(),n("p",ae,d(l.role_ids),1)):p("",!0)]),a("div",se,[a("label",te,[u(a("input",{"onUpdate:modelValue":e[5]||(e[5]=t=>s.value.is_active=t),type:"checkbox",class:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"},null,512),[[L,s.value.is_active]]),e[14]||(e[14]=a("span",{class:"text-sm text-gray-700"},"Akaun aktif",-1))])])]),a("div",le,[k(r,{to:{name:"users.index"},class:"btn-secondary"},{default:_(()=>[...e[15]||(e[15]=[w("Batal",-1)])]),_:1}),a("button",{type:"submit",disabled:c.value,class:"btn-primary"},d(c.value?"Menyimpan...":"Simpan Perubahan"),9,oe)])],32)])]))])}}};export{ve as default};
