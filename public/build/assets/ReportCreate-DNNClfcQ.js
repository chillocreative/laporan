import{o as V,c as n,a as t,w,t as m,d as S,e as c,v as b,E as k,F as C,q as D,f as v,g as N,r as o,y as R,i as M,j as U,k as d,h}from"./app-DO4Zvulx.js";import{u as j}from"./useNotification-eeoFgRbW.js";import{r as q}from"./reports-fszGUKBr.js";import{c as B}from"./categories-CTVfroS7.js";import{_ as E,a as F}from"./RichTextEditor-DOJ2cAZw.js";/* empty css            */import"./notifications-DYdMB6I5.js";const O={class:"max-w-3xl mx-auto"},T={class:"card"},A={class:"card-body"},$={key:0,class:"rounded-lg bg-red-50 p-3 text-sm text-red-700"},I={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},L=["value"],z=["max"],G={class:"flex items-center justify-end gap-3 pt-4 border-t border-gray-100"},H=["disabled"],ee={__name:"ReportCreate",setup(J){const y=U(),g=j(),x=R(()=>new Date().toISOString().split("T")[0]),f=o([]),s=o({title:"",category:"",description:"",incident_date:""}),u=o([]),r=o(!1),i=o("");V(async()=>{try{const{data:l}=await B.active();f.value=l.data}catch{}});async function _(){r.value=!0,i.value="";try{const l=new FormData;Object.entries(s.value).forEach(([e,p])=>l.append(e,p)),u.value.forEach(e=>l.append("attachments[]",e)),await q.create(l),g.success("Report submitted successfully!"),y.push({name:"reports.index"})}catch(l){const e=l.response?.data?.errors;i.value=e?Object.values(e).flat()[0]:"Failed to submit report."}finally{r.value=!1}}return(l,e)=>{const p=M("router-link");return d(),n("div",O,[e[11]||(e[11]=t("div",{class:"mb-6"},[t("h1",{class:"page-title"},"Create New Report"),t("p",{class:"page-subtitle"},"Submit a new report for review")],-1)),t("div",T,[t("div",A,[t("form",{onSubmit:w(_,["prevent"]),class:"space-y-5"},[i.value?(d(),n("div",$,m(i.value),1)):S("",!0),t("div",null,[e[5]||(e[5]=t("label",{class:"label-text"},"Title *",-1)),c(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>s.value.title=a),type:"text",required:"",class:"input-field",placeholder:"Brief title of the issue"},null,512),[[b,s.value.title]])]),t("div",I,[t("div",null,[e[7]||(e[7]=t("label",{class:"label-text"},"Category *",-1)),c(t("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>s.value.category=a),required:"",class:"input-field"},[e[6]||(e[6]=t("option",{value:""},"Select category",-1)),(d(!0),n(C,null,D(f.value,a=>(d(),n("option",{key:a,value:a},m(a),9,L))),128))],512),[[k,s.value.category]])]),t("div",null,[e[8]||(e[8]=t("label",{class:"label-text"},"Date *",-1)),c(t("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>s.value.incident_date=a),type:"date",required:"",class:"input-field",max:x.value},null,8,z),[[b,s.value.incident_date]])])]),t("div",null,[e[9]||(e[9]=t("label",{class:"label-text"},"Report *",-1)),v(E,{modelValue:s.value.description,"onUpdate:modelValue":e[3]||(e[3]=a=>s.value.description=a),placeholder:"Describe the issue in detail..."},null,8,["modelValue"])]),v(F,{modelValue:u.value,"onUpdate:modelValue":e[4]||(e[4]=a=>u.value=a),label:"Attachments (optional)"},null,8,["modelValue"]),t("div",G,[v(p,{to:{name:"reports.index"},class:"btn-secondary"},{default:N(()=>[...e[10]||(e[10]=[h("Cancel",-1)])]),_:1}),t("button",{type:"submit",disabled:r.value,class:"btn-primary"},m(r.value?"Submitting...":"Submit Report"),9,H)])],32)])])])}}};export{ee as default};
