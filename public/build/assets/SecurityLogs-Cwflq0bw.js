import{o as S,c as _,a,e as d,E as m,F as y,q as f,v as b,f as c,g as o,G as h,r as x,k as g,t as r,b as D,h as k}from"./app-C4KUgVyX.js";import{l as E}from"./logs-C_ALx0BJ.js";import{a as M}from"./formatters-mqXhrHnm.js";import{_ as A}from"./DataTable-Cf95o7My.js";import{_ as w}from"./Badge-kHOsy9ee.js";import{_ as U}from"./Pagination-C5qF7EKH.js";/* empty css            */import"./LoadingSpinner-BnFVoTYS.js";const B={class:"card mb-6"},F={class:"card-body"},N={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},$=["value"],j=["value"],q={class:"card"},z={class:"font-mono text-xs text-gray-500"},G={class:"text-sm text-gray-600 max-w-xs truncate block"},H={class:"text-xs text-gray-500"},I={class:"px-4 border-t border-gray-100"},ee={__name:"SecurityLogs",setup(O){const u=x([]),p=x(!0),i=h({currentPage:1,lastPage:1,total:0}),s=h({event_type:"",severity:"",date_from:"",date_to:""}),C=["failed_login","password_reset","account_locked","unauthorized_access","ip_blocked","suspicious_activity","brute_force","session_hijack"],P=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}],T=[{key:"event_type",label:"Event Type"},{key:"severity",label:"Severity"},{key:"ip_address",label:"IP Address"},{key:"description",label:"Description"},{key:"created_at",label:"Date"}];function L(l){return l&&{low:"green",medium:"yellow",high:"orange",critical:"red"}[l.toLowerCase()]||"gray"}async function n(l=1){p.value=!0;try{const t={...s,page:l,per_page:15};Object.keys(t).forEach(v=>{t[v]||delete t[v]});const{data:e}=await E.security(t);u.value=e.data,i.currentPage=e.meta?.current_page||1,i.lastPage=e.meta?.last_page||1,i.total=e.meta?.total||0}catch{u.value=[]}p.value=!1}function V(l){n(l)}return S(()=>n()),(l,t)=>(g(),_("div",null,[t[6]||(t[6]=a("div",{class:"mb-6"},[a("h1",{class:"page-title"},"Security Logs"),a("p",{class:"page-subtitle"},"Monitor security events and potential threats")],-1)),a("div",B,[a("div",F,[a("div",N,[d(a("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>s.event_type=e),onChange:n,class:"input-field"},[t[4]||(t[4]=a("option",{value:""},"All Event Types",-1)),(g(),_(y,null,f(C,e=>a("option",{key:e,value:e},r(e),9,$)),64))],544),[[m,s.event_type]]),d(a("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>s.severity=e),onChange:n,class:"input-field"},[t[5]||(t[5]=a("option",{value:""},"All Severities",-1)),(g(),_(y,null,f(P,e=>a("option",{key:e.value,value:e.value},r(e.label),9,j)),64))],544),[[m,s.severity]]),d(a("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>s.date_from=e),onChange:n,type:"date",class:"input-field",placeholder:"From date"},null,544),[[b,s.date_from]]),d(a("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>s.date_to=e),onChange:n,type:"date",class:"input-field",placeholder:"To date"},null,544),[[b,s.date_to]])])])]),a("div",q,[c(A,{columns:T,items:u.value,loading:p.value},{"cell-event_type":o(({item:e})=>[c(w,{color:"blue"},{default:o(()=>[k(r(e.event_type),1)]),_:2},1024)]),"cell-severity":o(({item:e})=>[c(w,{color:L(e.severity)},{default:o(()=>[k(r(e.severity),1)]),_:2},1032,["color"])]),"cell-ip_address":o(({item:e})=>[a("span",z,r(e.ip_address||"-"),1)]),"cell-description":o(({item:e})=>[a("span",G,r(e.description),1)]),"cell-created_at":o(({item:e})=>[a("span",H,r(D(M)(e.created_at)),1)]),_:1},8,["items","loading"]),a("div",I,[c(U,{"current-page":i.currentPage,"last-page":i.lastPage,total:i.total,onPageChange:V},null,8,["current-page","last-page","total"])])])]))}};export{ee as default};
