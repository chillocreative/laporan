import{o as E,c as n,a as t,f as c,g as x,s as M,w as N,t as v,d as A,e as f,v as _,E as B,F as D,q as U,r as l,y as j,j as q,i as F,n as O,k as r,h as w}from"./app-ClAtGGNd.js";import{u as T}from"./useNotification-BN3snHLO.js";import{r as V}from"./reports-CiahG0Em.js";import{c as $}from"./categories-2OI9ya0D.js";import{_ as I,a as L}from"./RichTextEditor-D601UFQI.js";import{_ as z}from"./LoadingSpinner-Cx3ytnbN.js";/* empty css            */import"./notifications-ioGSs1KQ.js";const G={class:"max-w-3xl mx-auto"},H={class:"mb-6"},J={key:1,class:"card"},K={class:"card-body"},P={key:0,class:"rounded-lg bg-red-50 p-3 text-sm text-red-700"},Q={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},W=["value"],X={class:"flex items-center justify-end gap-3 pt-4 border-t border-gray-100"},Y=["disabled"],ie={__name:"ReportEdit",props:{id:[String,Number]},setup(k){const h=k,R=O(),y=q(),S=T(),i=j(()=>h.id||R.params.id),g=l([]),s=l({title:"",category:"",description:"",incident_date:""}),m=l([]),b=l(!0),d=l(!1),u=l("");E(async()=>{try{const o=await $.active();g.value=o.data.data}catch{}try{const{data:o}=await V.get(i.value),e=o.data;s.value={title:e.title,category:e.category,description:e.description,incident_date:e.incident_date}}catch{y.push({name:"reports.index"})}b.value=!1});async function C(){d.value=!0,u.value="";try{const o=new FormData;Object.entries(s.value).forEach(([e,p])=>o.append(e,p)),m.value.forEach(e=>o.append("attachments[]",e)),await V.update(i.value,o),S.success("Report updated!"),y.push({name:"reports.show",params:{id:i.value}})}catch(o){const e=o.response?.data?.errors;u.value=e?Object.values(e).flat()[0]:"Failed to update."}finally{d.value=!1}}return(o,e)=>{const p=F("router-link");return r(),n("div",G,[t("div",H,[c(p,{to:{name:"reports.show",params:{id:i.value}},class:"text-sm text-gray-500 hover:text-primary-600 mb-1 inline-block"},{default:x(()=>[...e[5]||(e[5]=[w("â† Back",-1)])]),_:1},8,["to"]),e[6]||(e[6]=t("h1",{class:"page-title"},"Edit Report",-1))]),b.value?(r(),M(z,{key:0,"full-page":""})):(r(),n("div",J,[t("div",K,[t("form",{onSubmit:N(C,["prevent"]),class:"space-y-5"},[u.value?(r(),n("div",P,v(u.value),1)):A("",!0),t("div",null,[e[7]||(e[7]=t("label",{class:"label-text"},"Title *",-1)),f(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>s.value.title=a),type:"text",required:"",class:"input-field"},null,512),[[_,s.value.title]])]),t("div",Q,[t("div",null,[e[8]||(e[8]=t("label",{class:"label-text"},"Category *",-1)),f(t("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>s.value.category=a),required:"",class:"input-field"},[(r(!0),n(D,null,U(g.value,a=>(r(),n("option",{key:a,value:a},v(a),9,W))),128))],512),[[B,s.value.category]])]),t("div",null,[e[9]||(e[9]=t("label",{class:"label-text"},"Date *",-1)),f(t("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>s.value.incident_date=a),type:"date",required:"",class:"input-field"},null,512),[[_,s.value.incident_date]])])]),t("div",null,[e[10]||(e[10]=t("label",{class:"label-text"},"Report *",-1)),c(I,{modelValue:s.value.description,"onUpdate:modelValue":e[3]||(e[3]=a=>s.value.description=a)},null,8,["modelValue"])]),c(L,{modelValue:m.value,"onUpdate:modelValue":e[4]||(e[4]=a=>m.value=a),label:"Add More Attachments"},null,8,["modelValue"]),t("div",X,[c(p,{to:{name:"reports.show",params:{id:i.value}},class:"btn-secondary"},{default:x(()=>[...e[11]||(e[11]=[w("Cancel",-1)])]),_:1},8,["to"]),t("button",{type:"submit",disabled:d.value,class:"btn-primary"},v(d.value?"Saving...":"Save Changes"),9,Y)])],32)])]))])}}};export{ie as default};
