import{o as S,c as m,a,e as d,E as v,F as y,q as f,v as b,f as c,g as o,G as h,r as k,k as g,t as n,b as K,h as x}from"./app-CSiPyXD6.js";import{l as U}from"./logs-BviYPNq9.js";import{a as B}from"./formatters-mqXhrHnm.js";import{_ as D}from"./DataTable-DxRrS8nj.js";import{_ as P}from"./Badge-CIfH-R9m.js";import{_ as E}from"./Pagination-Dnkz0CfI.js";/* empty css            */import"./LoadingSpinner-cNTPVvEo.js";const F={class:"card mb-6"},M={class:"card-body"},N={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},$=["value"],j=["value"],A={class:"card"},J={class:"font-mono text-xs text-gray-500"},q={class:"text-sm text-gray-600 max-w-xs truncate block"},z={class:"text-xs text-gray-500"},G={class:"px-4 border-t border-gray-100"},ee={__name:"SecurityLogs",setup(I){const u=k([]),p=k(!0),r=h({currentPage:1,lastPage:1,total:0}),s=h({event_type:"",severity:"",date_from:"",date_to:""}),w=["failed_login","password_reset","account_locked","unauthorized_access","ip_blocked","suspicious_activity","brute_force","session_hijack"],T=[{value:"low",label:"Rendah"},{value:"medium",label:"Sederhana"},{value:"high",label:"Tinggi"},{value:"critical",label:"Kritikal"}],C=[{key:"event_type",label:"Jenis Peristiwa"},{key:"severity",label:"Keterukan"},{key:"ip_address",label:"Alamat IP"},{key:"description",label:"Penerangan"},{key:"created_at",label:"Tarikh"}];function V(l){return l&&{low:"green",medium:"yellow",high:"orange",critical:"red"}[l.toLowerCase()]||"gray"}async function i(l=1){p.value=!0;try{const t={...s,page:l,per_page:15};Object.keys(t).forEach(_=>{t[_]||delete t[_]});const{data:e}=await U.security(t);u.value=e.data,r.currentPage=e.meta?.current_page||1,r.lastPage=e.meta?.last_page||1,r.total=e.meta?.total||0}catch{u.value=[]}p.value=!1}function L(l){i(l)}return S(()=>i()),(l,t)=>(g(),m("div",null,[t[6]||(t[6]=a("div",{class:"mb-6"},[a("h1",{class:"page-title"},"Log Keselamatan"),a("p",{class:"page-subtitle"},"Pantau peristiwa keselamatan dan potensi ancaman")],-1)),a("div",F,[a("div",M,[a("div",N,[d(a("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>s.event_type=e),onChange:i,class:"input-field"},[t[4]||(t[4]=a("option",{value:""},"Semua Jenis Peristiwa",-1)),(g(),m(y,null,f(w,e=>a("option",{key:e,value:e},n(e),9,$)),64))],544),[[v,s.event_type]]),d(a("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>s.severity=e),onChange:i,class:"input-field"},[t[5]||(t[5]=a("option",{value:""},"Semua Tahap Keterukan",-1)),(g(),m(y,null,f(T,e=>a("option",{key:e.value,value:e.value},n(e.label),9,j)),64))],544),[[v,s.severity]]),d(a("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>s.date_from=e),onChange:i,type:"date",class:"input-field",placeholder:"From date"},null,544),[[b,s.date_from]]),d(a("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>s.date_to=e),onChange:i,type:"date",class:"input-field",placeholder:"To date"},null,544),[[b,s.date_to]])])])]),a("div",A,[c(D,{columns:C,items:u.value,loading:p.value},{"cell-event_type":o(({item:e})=>[c(P,{color:"blue"},{default:o(()=>[x(n(e.event_type),1)]),_:2},1024)]),"cell-severity":o(({item:e})=>[c(P,{color:V(e.severity)},{default:o(()=>[x(n(e.severity),1)]),_:2},1032,["color"])]),"cell-ip_address":o(({item:e})=>[a("span",J,n(e.ip_address||"-"),1)]),"cell-description":o(({item:e})=>[a("span",q,n(e.description),1)]),"cell-created_at":o(({item:e})=>[a("span",z,n(K(B)(e.created_at)),1)]),_:1},8,["items","loading"]),a("div",G,[c(E,{"current-page":r.currentPage,"last-page":r.lastPage,total:r.total,onPageChange:L},null,8,["current-page","last-page","total"])])])]))}};export{ee as default};
