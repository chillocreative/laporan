import{o as E,c as y,a as e,s as T,g as d,d as _,f as w,t as r,w as U,e as h,v as $,L as F,r as l,k as m,h as D}from"./app-CkgA-AoW.js";import{c as x}from"./categories-B6X8XmyS.js";import{_ as O}from"./DataTable-CRY2krIF.js";import{_ as z}from"./Badge-DmpLveg_.js";import{_ as q}from"./Alert-DKpLLnRQ.js";import{_ as H}from"./ConfirmDialog-kUwIuDDs.js";/* empty css            */import"./LoadingSpinner-B-34TY8e.js";const I={class:"card"},G={class:"font-medium text-gray-900"},J={class:"text-sm text-gray-500"},K={class:"flex items-center gap-2 justify-end"},P=["onClick"],Q=["onClick"],R={key:1,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},W={class:"relative bg-white rounded-xl shadow-xl w-full max-w-md p-6"},X={class:"text-lg font-semibold text-gray-900 mb-4"},Y={class:"grid grid-cols-2 gap-4"},Z={key:0,class:"flex items-end"},ee={class:"flex items-center gap-2 cursor-pointer"},te={key:0,class:"text-sm text-red-600"},ae={class:"flex justify-end gap-3 pt-2"},se=["disabled"],me={__name:"CategoryList",setup(le){const b=l([]),k=l(!0),n=l(!1),i=l(null),o=l({name:"",sort_order:0,is_active:!0}),u=l(""),p=l(!1),f=l(!1),c=l(null),g=l(""),V=l("success"),M=[{key:"name",label:"Name"},{key:"is_active",label:"Status"},{key:"sort_order",label:"Order"}];async function C(){k.value=!0;try{const{data:s}=await x.list();b.value=s.data}catch{v("error","Failed to load categories.")}k.value=!1}function L(){i.value=null,o.value={name:"",sort_order:b.value.length+1,is_active:!0},u.value="",n.value=!0}function N(s){i.value=s,o.value={name:s.name,sort_order:s.sort_order,is_active:s.is_active},u.value="",n.value=!0}async function j(){p.value=!0,u.value="";try{i.value?(await x.update(i.value.id,o.value),v("success","Category updated.")):(await x.store(o.value),v("success","Category created.")),n.value=!1,C()}catch(s){const t=s.response?.data?.errors;u.value=t?Object.values(t).flat()[0]:"Failed to save category."}p.value=!1}function S(s){c.value=s,f.value=!0}async function B(){f.value=!1;try{await x.delete(c.value.id),v("success",`Category '${c.value.name}' deleted.`),C()}catch{v("error","Failed to delete category.")}c.value=null}function v(s,t){V.value=s,g.value=t,setTimeout(()=>{g.value=""},4e3)}return E(C),(s,t)=>(m(),y("div",null,[e("div",{class:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6 gap-4"},[t[6]||(t[6]=e("div",null,[e("h1",{class:"page-title"},"Categories"),e("p",{class:"page-subtitle"},"Manage report categories")],-1)),e("button",{onClick:L,class:"btn-primary"},"+ New Category")]),g.value?(m(),T(q,{key:0,type:V.value,class:"mb-4"},{default:d(()=>[D(r(g.value),1)]),_:1},8,["type"])):_("",!0),e("div",I,[w(O,{columns:M,items:b.value,loading:k.value},{"cell-name":d(({item:a})=>[e("span",G,r(a.name),1)]),"cell-is_active":d(({item:a})=>[w(z,{color:a.is_active?"green":"red"},{default:d(()=>[D(r(a.is_active?"Active":"Inactive"),1)]),_:2},1032,["color"])]),"cell-sort_order":d(({item:a})=>[e("span",J,r(a.sort_order),1)]),actions:d(({item:a})=>[e("div",K,[e("button",{onClick:A=>N(a),class:"text-gray-400 hover:text-primary-600",title:"Edit"},[...t[7]||(t[7]=[e("svg",{class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125"})],-1)])],8,P),e("button",{onClick:A=>S(a),class:"text-gray-400 hover:text-red-600",title:"Delete"},[...t[8]||(t[8]=[e("svg",{class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})],-1)])],8,Q)])]),_:1},8,["items","loading"])]),n.value?(m(),y("div",R,[e("div",{class:"fixed inset-0 bg-black/50",onClick:t[0]||(t[0]=a=>n.value=!1)}),e("div",W,[e("h3",X,r(i.value?"Edit Category":"New Category"),1),e("form",{onSubmit:U(j,["prevent"]),class:"space-y-4"},[e("div",null,[t[9]||(t[9]=e("label",{class:"label-text"},"Name *",-1)),h(e("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>o.value.name=a),type:"text",required:"",class:"input-field",placeholder:"Category name"},null,512),[[$,o.value.name]])]),e("div",Y,[e("div",null,[t[10]||(t[10]=e("label",{class:"label-text"},"Sort Order",-1)),h(e("input",{"onUpdate:modelValue":t[2]||(t[2]=a=>o.value.sort_order=a),type:"number",min:"0",class:"input-field"},null,512),[[$,o.value.sort_order,void 0,{number:!0}]])]),i.value?(m(),y("div",Z,[e("label",ee,[h(e("input",{"onUpdate:modelValue":t[3]||(t[3]=a=>o.value.is_active=a),type:"checkbox",class:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"},null,512),[[F,o.value.is_active]]),t[11]||(t[11]=e("span",{class:"text-sm text-gray-700"},"Active",-1))])])):_("",!0)]),u.value?(m(),y("div",te,r(u.value),1)):_("",!0),e("div",ae,[e("button",{type:"button",onClick:t[4]||(t[4]=a=>n.value=!1),class:"btn-secondary"},"Cancel"),e("button",{type:"submit",disabled:p.value,class:"btn-primary"},r(p.value?"Saving...":"Save"),9,se)])],32)])])):_("",!0),w(H,{modelValue:f.value,"onUpdate:modelValue":t[5]||(t[5]=a=>f.value=a),title:"Delete Category",message:`Are you sure you want to delete '${c.value?.name}'?`,"confirm-text":"Delete",danger:!0,onConfirm:B},null,8,["modelValue","message"])]))}};export{me as default};
