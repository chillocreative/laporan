import{u as U,o as V,c as i,a,w as h,t as l,d as p,e as f,v as b,r as m,G as j,k as n,D as E}from"./app-C4mD1gYF.js";import{u as M}from"./useAuth-D7dfYpNE.js";import{u as O}from"./useNotification-CHfM3yRx.js";/* empty css            */import"./notifications-DJdsW7qO.js";const q={class:"max-w-3xl mx-auto"},B={class:"card mb-6"},L={class:"card-body"},N={key:0,class:"rounded-lg bg-red-50 p-3 text-sm text-red-700"},D={key:0,class:"mt-1 text-xs text-red-600"},G={key:0,class:"mt-1 text-xs text-red-600"},A={class:"flex justify-end pt-4 border-t border-gray-100"},F=["disabled"],T={class:"card"},C={class:"card-body"},z={key:0,class:"rounded-lg bg-red-50 p-3 text-sm text-red-700"},H={key:1,class:"rounded-lg bg-green-50 p-3 text-sm text-green-700"},I={key:0,class:"mt-1 text-xs text-red-600"},J={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Q={key:0,class:"mt-1 text-xs text-red-600"},R={class:"flex justify-end pt-4 border-t border-gray-100"},W=["disabled"],se={__name:"ProfilePage",setup(X){const _=M(),P=U(),k=O(),r=m({name:"",email:""}),c=m(""),d=j({}),y=m(!1),o=m({current_password:"",password:"",password_confirmation:""}),v=m(""),x=m(""),u=j({}),w=m(!1);V(()=>{r.value.name=_.user.value?.name||"",r.value.email=_.user.value?.email||""});async function K(){y.value=!0,c.value="",Object.keys(d).forEach(t=>delete d[t]);try{await E.put("/profile",{name:r.value.name,email:r.value.email}),await P.fetchUser(),k.success("Profil berjaya dikemas kini!")}catch(t){const e=t.response?.data?.errors;e?(Object.entries(e).forEach(([s,g])=>{d[s]=g[0]}),c.value=Object.values(e).flat()[0]):c.value=t.response?.data?.message||"Gagal mengemas kini profil."}finally{y.value=!1}}async function S(){w.value=!0,v.value="",x.value="",Object.keys(u).forEach(t=>delete u[t]);try{await E.put("/profile/password",o.value),o.value={current_password:"",password:"",password_confirmation:""},x.value="Kata laluan berjaya dikemas kini!",k.success("Kata laluan berjaya dikemas kini!")}catch(t){const e=t.response?.data?.errors;e?(Object.entries(e).forEach(([s,g])=>{u[s]=g[0]}),v.value=Object.values(e).flat()[0]):v.value=t.response?.data?.message||"Gagal mengemas kini kata laluan."}finally{w.value=!1}}return(t,e)=>(n(),i("div",q,[e[12]||(e[12]=a("h1",{class:"page-title mb-6"},"Profil",-1)),a("div",B,[a("div",L,[e[7]||(e[7]=a("h2",{class:"text-base font-semibold text-gray-900 mb-4"},"Maklumat Peribadi",-1)),a("form",{onSubmit:h(K,["prevent"]),class:"space-y-5"},[c.value?(n(),i("div",N,l(c.value),1)):p("",!0),a("div",null,[e[5]||(e[5]=a("label",{class:"label-text"},"Nama *",-1)),f(a("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>r.value.name=s),type:"text",required:"",class:"input-field"},null,512),[[b,r.value.name]]),d.name?(n(),i("p",D,l(d.name),1)):p("",!0)]),a("div",null,[e[6]||(e[6]=a("label",{class:"label-text"},"E-mel *",-1)),f(a("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>r.value.email=s),type:"email",required:"",class:"input-field"},null,512),[[b,r.value.email]]),d.email?(n(),i("p",G,l(d.email),1)):p("",!0)]),a("div",A,[a("button",{type:"submit",disabled:y.value,class:"btn-primary"},l(y.value?"Menyimpan...":"Simpan Perubahan"),9,F)])],32)])]),a("div",T,[a("div",C,[e[11]||(e[11]=a("h2",{class:"text-base font-semibold text-gray-900 mb-4"},"Tukar Kata Laluan",-1)),a("form",{onSubmit:h(S,["prevent"]),class:"space-y-5"},[v.value?(n(),i("div",z,l(v.value),1)):p("",!0),x.value?(n(),i("div",H,l(x.value),1)):p("",!0),a("div",null,[e[8]||(e[8]=a("label",{class:"label-text"},"Kata Laluan Semasa *",-1)),f(a("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>o.value.current_password=s),type:"password",required:"",class:"input-field"},null,512),[[b,o.value.current_password]]),u.current_password?(n(),i("p",I,l(u.current_password),1)):p("",!0)]),a("div",J,[a("div",null,[e[9]||(e[9]=a("label",{class:"label-text"},"Kata Laluan Baru *",-1)),f(a("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>o.value.password=s),type:"password",required:"",class:"input-field"},null,512),[[b,o.value.password]]),u.password?(n(),i("p",Q,l(u.password),1)):p("",!0)]),a("div",null,[e[10]||(e[10]=a("label",{class:"label-text"},"Sahkan Kata Laluan Baru *",-1)),f(a("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>o.value.password_confirmation=s),type:"password",required:"",class:"input-field"},null,512),[[b,o.value.password_confirmation]])])]),a("div",R,[a("button",{type:"submit",disabled:w.value,class:"btn-primary"},l(w.value?"Mengemas kini...":"Kemas Kini Kata Laluan"),9,W)])],32)])])]))}};export{se as default};
