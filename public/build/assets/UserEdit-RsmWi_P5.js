import{o as M,c as n,a as s,f as g,g as w,s as j,w as B,t as d,d as m,e as u,v as f,E as R,F as q,q as L,L as h,y as A,r as c,j as F,i as O,G as P,n as D,k as r,h as k}from"./app-CkgA-AoW.js";import{u as T}from"./useNotification-Dz5CEwoZ.js";import{u as U}from"./users-Pj1-Xddz.js";import{r as G}from"./roles-BZvqwXPl.js";import{_ as I}from"./LoadingSpinner-B-34TY8e.js";/* empty css            */import"./notifications-lGq0ZMx-.js";const $={class:"max-w-3xl mx-auto"},z={class:"mb-6"},H={key:1,class:"card"},J={class:"card-body"},K={key:0,class:"rounded-lg bg-red-50 p-3 text-sm text-red-700"},Q={key:0,class:"mt-1 text-xs text-red-600"},W={key:0,class:"mt-1 text-xs text-red-600"},X={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Y={key:0,class:"mt-1 text-xs text-red-600"},Z={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},ee=["value"],se={key:0,class:"mt-1 text-xs text-red-600"},te={class:"flex items-end"},ae={class:"flex items-center gap-2 cursor-pointer"},le={class:"flex items-center justify-end gap-3 pt-4 border-t border-gray-100"},oe=["disabled"],ce={__name:"UserEdit",props:{id:[String,Number]},setup(V){const E=V,N=D(),x=F(),S=T(),b=A(()=>E.id||N.params.id),t=c({name:"",email:"",password:"",password_confirmation:"",role_id:"",is_active:!0}),y=c([]),_=c(!0),v=c(!1),p=c(""),l=P({});M(async()=>{try{const[o,e]=await Promise.all([U.get(b.value),G.assignable()]),i=o.data.data;t.value={name:i.name,email:i.email,password:"",password_confirmation:"",role_id:i.roles?.[0]?.id||"",is_active:!!i.is_active},y.value=e.data.data}catch{x.push({name:"users.index"})}_.value=!1});async function C(){v.value=!0,p.value="",Object.keys(l).forEach(o=>delete l[o]);try{const o={name:t.value.name,email:t.value.email,role_ids:[t.value.role_id],is_active:t.value.is_active?1:0};t.value.password&&(o.password=t.value.password,o.password_confirmation=t.value.password_confirmation),await U.update(b.value,o),S.success("User updated successfully!"),x.push({name:"users.index"})}catch(o){const e=o.response?.data?.errors;e?(Object.entries(e).forEach(([i,a])=>{l[i]=a[0]}),p.value=Object.values(e).flat()[0]):p.value=o.response?.data?.message||"Failed to update user."}finally{v.value=!1}}return(o,e)=>{const i=O("router-link");return r(),n("div",$,[s("div",z,[g(i,{to:{name:"users.index"},class:"text-sm text-gray-500 hover:text-primary-600 mb-1 inline-block"},{default:w(()=>[...e[6]||(e[6]=[k("â† Back to Users",-1)])]),_:1}),e[7]||(e[7]=s("h1",{class:"page-title"},"Edit User",-1))]),_.value?(r(),j(I,{key:0,"full-page":""})):(r(),n("div",H,[s("div",J,[s("form",{onSubmit:B(C,["prevent"]),class:"space-y-5"},[p.value?(r(),n("div",K,d(p.value),1)):m("",!0),s("div",null,[e[8]||(e[8]=s("label",{class:"label-text"},"Name *",-1)),u(s("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>t.value.name=a),type:"text",required:"",class:"input-field"},null,512),[[f,t.value.name]]),l.name?(r(),n("p",Q,d(l.name),1)):m("",!0)]),s("div",null,[e[9]||(e[9]=s("label",{class:"label-text"},"Email *",-1)),u(s("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>t.value.email=a),type:"email",required:"",class:"input-field"},null,512),[[f,t.value.email]]),l.email?(r(),n("p",W,d(l.email),1)):m("",!0)]),s("div",X,[s("div",null,[e[10]||(e[10]=s("label",{class:"label-text"},"New Password",-1)),u(s("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>t.value.password=a),type:"password",class:"input-field",placeholder:"Leave blank to keep current"},null,512),[[f,t.value.password]]),l.password?(r(),n("p",Y,d(l.password),1)):m("",!0)]),s("div",null,[e[11]||(e[11]=s("label",{class:"label-text"},"Confirm Password",-1)),u(s("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>t.value.password_confirmation=a),type:"password",class:"input-field",placeholder:"Leave blank to keep current"},null,512),[[f,t.value.password_confirmation]])])]),s("div",Z,[s("div",null,[e[13]||(e[13]=s("label",{class:"label-text"},"Role *",-1)),u(s("select",{"onUpdate:modelValue":e[4]||(e[4]=a=>t.value.role_id=a),required:"",class:"input-field"},[e[12]||(e[12]=s("option",{value:""},"Select role",-1)),(r(!0),n(q,null,L(y.value,a=>(r(),n("option",{key:a.id,value:a.id},d(a.name),9,ee))),128))],512),[[R,t.value.role_id]]),l.role_ids?(r(),n("p",se,d(l.role_ids),1)):m("",!0)]),s("div",te,[s("label",ae,[u(s("input",{"onUpdate:modelValue":e[5]||(e[5]=a=>t.value.is_active=a),type:"checkbox",class:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"},null,512),[[h,t.value.is_active]]),e[14]||(e[14]=s("span",{class:"text-sm text-gray-700"},"Active account",-1))])])]),s("div",le,[g(i,{to:{name:"users.index"},class:"btn-secondary"},{default:w(()=>[...e[15]||(e[15]=[k("Cancel",-1)])]),_:1}),s("button",{type:"submit",disabled:v.value,class:"btn-primary"},d(v.value?"Saving...":"Save Changes"),9,oe)])],32)])]))])}}};export{ce as default};
